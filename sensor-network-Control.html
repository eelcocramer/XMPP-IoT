<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>XEP-0325: Internet of Things - Control</title>
    <link rel="stylesheet" type="text/css" href="xmpp.css">
    <link href="prettify.css" type="text/css" rel="stylesheet">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"><script type="text/javascript" src="prettify.js"></script><meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0">
    <meta name="DC.Title" content="Internet of Things - Control">
    <meta name="DC.Creator" content="Peter Waher">
    <meta name="DC.Description" content="This specification describes how to control devices or actuators in an XMPP-based sensor network.">
    <meta name="DC.Publisher" content="XMPP Standards Foundation">
    <meta name="DC.Contributor" content="XMPP Extensions Editor">
    <meta name="DC.Date" content="2013-06-19">
    <meta name="DC.Type" content="XMPP Extension Protocol">
    <meta name="DC.Format" content="XHTML">
    <meta name="DC.Identifier" content="XEP-0325">
    <meta name="DC.Language" content="en">
    <meta name="DC.Rights" content="This XMPP Extension Protocol is copyright (c) 1999 - 2013 by the XMPP Standards Foundation (XSF).">
  </head>
  <body onload="prettyPrint()">
    <h1>XEP-0325: Internet of Things - Control</h1>
    <table>
      <tr valign="top">
        <td><strong>Abstract:</strong></td>
        <td>This specification describes how to control devices or actuators in an XMPP-based sensor network.</td>
      </tr>
      <tr valign="top">
        <td><strong>Author:</strong></td>
        <td>Peter Waher</td>
      </tr>
      <tr valign="top">
        <td><strong>Copyright:</strong></td>
        <td>© 1999 - 2013 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</td>
      </tr>
      <tr valign="top">
        <td><strong>Status:</strong></td>
        <td>Experimental</td>
      </tr>
      <tr valign="top">
        <td><strong>Type:</strong></td>
        <td>Standards Track</td>
      </tr>
      <tr valign="top">
        <td><strong>Version:</strong></td>
        <td>0.1.2</td>
      </tr>
      <tr valign="top">
        <td><strong>Last Updated:</strong></td>
        <td>2013-06-19</td>
      </tr>
    </table>
    <hr>
    <p style="color:red">WARNING: This Standards-Track document is Experimental. Publication as an XMPP Extension Protocol does not imply approval of this proposal by the XMPP Standards Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems are advised to carefully consider whether it is appropriate to deploy implementations of this protocol before it advances to a status of Draft.</p>
    <hr>
    <h2>Table of Contents</h2>
    <div class="indent">
      <p><br>1.  <a href="#intro">Introduction</a><br>2.  <a href="#glossary">Glossary</a><br>3.  <a href="#usecases">Use Cases</a><br>   
      3.1.  <a href="#sect-ID0E2MAC">Control commands</a><br>      
      3.1.1.  <a href="#sect-ID0E6MAC">Sending a control command using a message stanza</a><br>      
      3.1.2.  <a href="#sect-ID0EPNAC">Sending a control command using an IQ stanza</a><br>      
      3.1.3.  <a href="#sect-ID0E6NAC">Control failure response</a><br>   
      3.2.  <a href="#sect-ID0EMOAC">Setting control parameters</a><br>      
      3.2.1.  <a href="#sect-ID0EUOAC">Setting a single boolean-valued control parameter</a><br>      
      3.2.2.  <a href="#sect-ID0EAPAC">Setting a single 32-bit integer-valued control parameter</a><br>      
      3.2.3.  <a href="#sect-ID0EMPAC">Setting a single 64-bit integer-valued control parameter</a><br>      
      3.2.4.  <a href="#sect-ID0EYPAC">Setting a single string-valued control parameter</a><br>      
      3.2.5.  <a href="#sect-ID0EFAAE">Setting a single double-valued control parameter</a><br>      
      3.2.6.  <a href="#sect-ID0ERAAE">Setting a single date-valued control parameter</a><br>      
      3.2.7.  <a href="#sect-ID0E4AAE">Setting a single time-valued control parameter</a><br>      
      3.2.8.  <a href="#sect-ID0EJBAE">Setting a single date &amp; time-valued control parameter</a><br>      
      3.2.9.  <a href="#sect-ID0EVBAE">Setting a single time-valued control parameter</a><br>      
      3.2.10.  <a href="#sect-ID0EBCAE">Setting a single duration-valued control parameter</a><br>      
      3.2.11.  <a href="#sect-ID0ENCAE">Setting a single color-valued control parameter</a><br>      
      3.2.12.  <a href="#sect-ID0EZCAE">Setting multiple control parameters at once</a><br>   
      3.3.  <a href="#sect-ID0EYDAE">Control forms</a><br>      
      3.3.1.  <a href="#controlform">Getting a control form</a><br>      
      3.3.2.  <a href="#sect-ID0EXFAE">Getting a control form, Failure</a><br>      
      3.3.3.  <a href="#sect-ID0EKGAE">Setting a (partial) control form</a><br>      
      3.3.4.  <a href="#sect-ID0E5GAE">Setting a (partial) control form, Failure</a><br>   
      3.4.  <a href="#sect-ID0EUHAE">Controlling devices behind a concentrator</a><br>      
      3.4.1.  <a href="#sect-ID0E6HAE">Sending a control command to a node behind a concentrator</a><br>      
      3.4.2.  <a href="#sect-ID0EOIAE">Sending a control command to multiple nodes</a><br>      
      3.4.3.  <a href="#sect-ID0E4IAE">Sending a control command to multiple nodes, Failure</a><br>      
      3.4.4.  <a href="#sect-ID0EJJAE">Getting a control form from multiple nodes</a><br>      
      3.4.5.  <a href="#sect-ID0EBKAE">Getting a control form from multiple nodes, Failure</a><br>      
      3.4.6.  <a href="#sect-ID0EUKAE">Setting a (partial) control form to multiple nodes</a><br>      
      3.4.7.  <a href="#sect-ID0EFLAE">Setting a (partial) control form to multiple nodes, Failure</a><br>4.  <a href="#support">Determining Support</a><br>5.  <a href="#impl">Implementation Notes</a><br>   
      5.1.  <a href="#sect-ID0ELNAE">Reading current control states</a><br>   
      5.2.  <a href="#nodeparamsvscontrolparams">Difference between node parameters and node control parameters</a><br>   
      5.3.  <a href="#parametergroups">Grouping control parameters</a><br>   
      5.4.  <a href="#sect-ID0EVFAG">Node commands vs. control parameters</a><br>   
      5.5.  <a href="#sect-ID0EFIAG">Tokens</a><br>   
      5.6.  <a href="#sect-ID0EGKAG">Controlling devices in large subsystems</a><br>6.  <a href="#i18n">Internationalization Considerations</a><br>   
      6.1.  <a href="#sect-ID0EMLAG">Time Zones</a><br>   
      6.2.  <a href="#sect-ID0EAMAG">xml:lang</a><br>7.  <a href="#security">Security Considerations</a><br>   
      7.1.  <a href="#sect-ID0EVMAG">Encryption &amp; Authentication</a><br>   
      7.2.  <a href="#sect-ID0ECNAG">Provisioning</a><br>8.  <a href="#iana">IANA Considerations</a><br>9.  <a href="#registrar">XMPP Registrar Considerations</a><br>10.  <a href="#schema">XML Schema</a><br>11.  <a href="#moreinfo">For more information</a><br>12.  <a href="#ack">Acknowledgements</a></p>
      <p><a href="#appendices">Appendices</a><br>    <a href="#appendix-docinfo">A: Document Information</a><br>    <a href="#appendix-authorinfo">B: Author Information</a><br>    <a href="#appendix-legal">C: Legal Notices</a><br>    <a href="#appendix-xmpp">D: Relation to XMPP</a><br>    <a href="#appendix-discuss">E: Discussion Venue</a><br>    <a href="#appendix-conformance">F: Requirements Conformance</a><br>    <a href="#appendix-notes">G: Notes</a><br>    <a href="#appendix-revs">H: Revision History</a></p>
    </div>
    <hr>
    <h2>1.
       <a name="intro">Introduction</a></h2>
        <p class="" style="">
            Actuators are devices in sensor networks that can be controlled through the network and act with the outside world. In sensor networks and Internet of Things applications,
            actuators make it possible to automate real-world processes. This document defines a mechanism whereby actuators can be controlled in XMPP-based sensor networks, making it
            possible to integrate sensors and actuators of different brands, makes and models into larger Internet of Things applications.
        </p>
        <p class="" style="">
            Note has to be taken, that these XEP's are designed for implementation in sensors, many of which have very limited amount of memory (both RAM and ROM) or resources (processing power).
            Therefore, simplicity is of utmost importance. Furthermore, sensor networks can become huge, easily with millions of devices in peer-to-peer networks.
        </p>
        <p class="" style="">
            Sensor networks contains many different architectures and use cases. For this reason, the sensor network standards have been divided into multiple XEPs according to the following table:
        </p>
        <div class="indent">
      <p class="caption"><a name="table-1"></a>Table 1: Sensor Network XEPs</p>
      <table border="1" cellpadding="3" cellspacing="0">
            <tr class="body">
                <th colspan="" rowspan="">XEP</th>
                <th colspan="" rowspan="">Description</th>
            </tr>
            <tr class="body">
                <td colspan="" rowspan="">dynamic-forms</td>
                <td colspan="" rowspan="">Defines extensions for how dynamic forms can be created, based on <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0004.html">Data Forms</a></span>  [<a href="#nt-ID0ETG">1</a>], <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0122.html">Data Forms Validation</a></span>  [<a href="#nt-ID0E6G">2</a>], <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0137.html">Publishing Stream Initiation Requests</a></span>  [<a href="#nt-ID0ELH">3</a>] and <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0141.html">Data Forms Layout</a></span>  [<a href="#nt-ID0EXH">4</a>].</td>
            </tr>
            <tr class="body">
                <td colspan="" rowspan="">xep-0000-IoT-BatteryPoweredSensors</td>
                <td colspan="" rowspan="">Defines how to handle the peculiars related to battery powered devices, and other devices intermittently available on the network.</td>
            </tr>
            <tr class="body">
                <td colspan="" rowspan="">xep-0000-IoT-Discovery</td>
                <td colspan="" rowspan="">Defines the peculiars of sensor discovery in sensor networks. Apart from discovering sensors by JID, it also defines how to discover sensors based on location, etc.</td>
            </tr>
            <tr class="body">
                <td colspan="" rowspan="">xep-0000-IoT-Events</td>
                <td colspan="" rowspan="">Defines how sensors send events, how event subscription, hysteresis levels, etc., are configured.</td>
            </tr>
            <tr class="body">
                <td colspan="" rowspan="">xep-0000-IoT-Interoperability</td>
                <td colspan="" rowspan="">Defines guidelines for how to achieve interoperability in sensor networks, publishing interoperability interfaces for different types of devices.</td>
            </tr>
            <tr class="body">
                <td colspan="" rowspan="">xep-0000-IoT-Multicast</td>
                <td colspan="" rowspan="">Defines how sensor data can be multicast in efficient ways.</td>
            </tr>
            <tr class="body">
                <td colspan="" rowspan="">xep-0000-IoT-PubSub</td>
                <td colspan="" rowspan="">Defines how efficient publication of sensor data can be made in sensor networks.</td>
            </tr>
			<tr class="body">
				<td colspan="" rowspan="">XEP-0322</td>
				<td colspan="" rowspan="">
					Defines how to EXI can be used in XMPP to achieve efficient compression of data. Albeit not a sensor network specific XEP, this XEP should be considered
					in all sensor network implementations where memory and packet size is an issue.
				</td>
			</tr>
			<tr class="body">
                <td colspan="" rowspan="">XEP-0323</td>
                <td colspan="" rowspan="">
                    Provides the underlying architecture, basic operations and data structures for sensor data communication over XMPP networks.
                    It includes a hardware abstraction model, removing any technical detail implemented in underlying technologies. This XEP is used by all other sensor network XEPs.
                </td>
            </tr>
			<tr class="body">
				<td colspan="" rowspan="">XEP-0324</td>
				<td colspan="" rowspan="">Defines how provisioning, the management of access privileges, etc., can be efficiently and easily implemented.</td>
			</tr>
			<tr class="body">
				<td colspan="" rowspan="">XEP-0325</td>
				<td colspan="" rowspan="">This specification. Defines how to control actuators and other devices in Internet of Things.</td>
			</tr>
			<tr class="body">
				<td colspan="" rowspan="">XEP-0326</td>
				<td colspan="" rowspan="">Defines how to handle architectures containing concentrators or servers handling multiple sensors.</td>
			</tr>
			<tr class="body">
				<td colspan="" rowspan="">XEP-0331</td>
				<td colspan="" rowspan="">Defines extensions for how color parameters can be handled, based on <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0004.html">Data Forms</a></span>  [<a href="#nt-ID0EJEAC">5</a>]</td>
			</tr>
		</table>
    </div>
    <h2>2.
       <a name="glossary">Glossary</a></h2>
        <p class="" style="">The following table lists common terms and corresponding descriptions.</p>
        <div class="indent">
      <dl>
            <di>
                <dt><strong>Actuator</strong></dt>
                <dd>Device containing at least one configurable property or output that can and should be controlled by some other entity or device.</dd>
            </di>
            <di>
                <dt><strong>Computed Value</strong></dt>
                <dd>A value that is computed instead of measured.</dd>
            </di>
            <di>
                <dt><strong>Concentrator</strong></dt>
                <dd>Device managing a set of devices which it publishes on the XMPP network.</dd>
            </di>
            <di>
                <dt><strong>Field</strong></dt>
                <dd>
                    One item of sensor data. Contains information about: Node, Field Name, Value, Precision, Unit, Value Type, Status, Timestamp, Localization information, etc.
                    Fields should be unique within the triple (Node ID, Field Name, Timestamp).
                </dd>
            </di>
            <di>
                <dt><strong>Field Name</strong></dt>
                <dd>Name of a field of sensor data. Examples: Energy, Volume, Flow, Power, etc.</dd>
            </di>
            <di>
                <dt><strong>Field Type</strong></dt>
                <dd>What type of value the field represents. Examples: Momentary Value, Status Value, Identification Value, Calculated Value, Peak Value, Historical Value, etc.</dd>
            </di>
            <di>
                <dt><strong>Historical Value</strong></dt>
                <dd>A value stored in memory from a previous timestamp.</dd>
            </di>
            <di>
                <dt><strong>Identification Value</strong></dt>
                <dd>A value that can be used for identification. (Serial numbers, meter IDs, locations, names, etc.)</dd>
            </di>
            <di>
                <dt><strong>Localization information</strong></dt>
                <dd>Optional information for a field, allowing the sensor to control how the information should be presented to human viewers.</dd>
            </di>
            <di>
                <dt><strong>Meter</strong></dt>
                <dd>A device possible containing multiple sensors, used in metering applications. Examples: Electricity meter, Water Meter, Heat Meter, Cooling Meter, etc.</dd>
            </di>
            <di>
                <dt><strong>Momentary Value</strong></dt>
                <dd>A momentary value represents a value measured at the time of the read-out.</dd>
            </di>
            <di>
                <dt><strong>Node</strong></dt>
                <dd>
					Graphs contain nodes and edges between nodes. In Internet of Things, sensors, actuators, meters, devices, gatewats, etc., are often depicted as nodes whereas links between sensors (friendships)
					are depicted as edges. In abstract terms, it's easier to talk about a Node, rather than list different possible node types (sensors, actuators, meters, devices, gateways, etc.).
					Each Node has a Node ID.
				</dd>
            </di>
            <di>
                <dt><strong>Node ID</strong></dt>
                <dd>
                    An ID uniquely identifying a node within its corresponding context. If a globally unique ID is desired, an architecture should be used using a universally accepted
                    ID scheme.
                </dd>
            </di>
            <di>
                <dt><strong>Parameter</strong></dt>
                <dd>
                    Readable and/or writable property on a node/device. The XEP-0326 <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a></span>  [<a href="#nt-ID0EDIAC">6</a>] deals with reading and writing parameters
                    on nodes/devices. Fields are not parameters, and parameters are not fields.
                </dd>
            </di>
            <di>
                <dt><strong>Peak Value</strong></dt>
                <dd>A maximum or minimum value during a given period.</dd>
            </di>
            <di>
                <dt><strong>Precision</strong></dt>
                <dd>
                    In physics, precision determines the number of digits of precision. In sensor networks however, this definition is not easily applicable. Instead, precision
                    determines, for example, the number of decimals of precision, or power of precision. Example: 123.200 MWh contains 3 decimals of precision. All entities parsing and
                    delivering field information in sensor networks should always retain the number of decimals in a message.
                </dd>
            </di>
            <di>
                <dt><strong>Sensor</strong></dt>
                <dd>
                    Device measuring at least one digital value (0 or 1) or analog value (value with precision and physical unit). Examples: Temperature sensor, pressure sensor, etc.
                    Sensor values are reported as fields during read-out. Each sensor has a unique Node ID.
                </dd>
            </di>
            <di>
                <dt><strong>SN</strong></dt>
                <dd>Sensor Network. A network consisting, but not limited to sensors, where transport and use of sensor data is of primary concern. A sensor network may contain actuators, network applications, monitors, services, etc.</dd>
            </di>
            <di>
                <dt><strong>Status Value</strong></dt>
                <dd>A value displaying status information about something.</dd>
            </di>
            <di>
                <dt><strong>Timestamp</strong></dt>
                <dd>Timestamp of value, when the value was sampled or recorded.</dd>
            </di>
            <di>
                <dt><strong>Token</strong></dt>
                <dd>
                    A client, device or user can get a token from a provisioning server. These tokens can be included in requests to other entities in the network, so these entities can validate
                    access rights with the provisioning server.
                </dd>
            </di>
            <di>
                <dt><strong>Unit</strong></dt>
                <dd>Physical unit of value. Example: MWh, l/s, etc.</dd>
            </di>
            <di>
                <dt><strong>Value</strong></dt>
                <dd>A field value.</dd>
            </di>
            <di>
                <dt><strong>Value Status</strong></dt>
                <dd>Status of field value. Contains important status information for Quality of Service purposes. Examples: Ok, Error, Warning, Time Shifted, Missing, Signed, etc.</dd>
            </di>
            <di>
                <dt><strong>Value Type</strong></dt>
                <dd>Can be numeric, string, boolean, Date &amp; Time, Time Span or Enumeration.</dd>
            </di>
            <di>
                <dt><strong>WSN</strong></dt>
                <dd>Wireless Sensor Network, a sensor network including wireless devices.</dd>
            </di>
            <di>
                <dt><strong>XMPP Client</strong></dt>
                <dd>Application connected to an XMPP network, having a JID. Note that sensors, as well as applications requesting sensor data can be XMPP clients.</dd>
            </di>
        </dl>
    </div>
    <h2>3.
       <a name="usecases">Use Cases</a></h2>
        <p class="" style="">
            Control in sensor networks is about setting output values. To make the implementation simple, it is assumed that control of a device can be made using a single message.
            If only a simple set operation is requested, a &lt;message&gt; stanza can be sent. If an acknowledgement (ACK) of the operation (or Not-acknowledgement NACK) of the operation
            is desired, an &lt;iq&gt; stanza can be used instead.
        </p>
        <p class="" style="">
            To set control parameters in a device, the <span class="strong">set</span> command is sent to the device. The set command allows for two different ways of setting control parameters:
        </p>
        <ul class="" style="">
            <li class="" style="">Using strongly typed parameters. This way performs best in EXI compression and automation.</li>
            <li class="" style="">Using a weakly typed data form. This might be better for manually setting control parameters, since it allows the device to give the user a better user interface explaining
            available control parameters.</li>
        </ul>
        <p class="" style="">
            What type of control parameters there are available in different types of devices is described in
             [<a href="#nt-ID0EIMAC">7</a>].
        </p>
        <p class="" style="">
            If the device is a concentrator, as defined in <a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a>, 
			an handles multiple nodes behind it, which node(s) to control is defined using <span class="strong">node</span> elements. If not a concentrator,
            the use of <span class="strong">node</span> elements is not necessary, and control commands are sent directly to the device itself.
        </p>
        <div class="indent">
      <h3>3.1 <a name="sect-ID0E2MAC">Control commands</a></h3>
            <div class="indent">
        <h3>3.1.1 <a name="sect-ID0E6MAC">Sending a control command using a message stanza</a></h3>
                <p class="" style="">
                    Following is an example of a control command sent using a message stanza:
                </p>
                <p class="caption"><a name="example-1"></a>Example 1. Message stanza for setting a value</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='digital.output@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;boolean name='Output' value='true'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
                <p class="" style="">
                    Note that any response is supressed when sending a message stanza, regardless if the desired control command could be executed or not. The following example shows how the same
                    control command could be issued using an IQ stanza instead:
                </p>
            </div>
            <div class="indent">
        <h3>3.1.2 <a name="sect-ID0EPNAC">Sending a control command using an IQ stanza</a></h3>
                <p class="" style="">
                    Following is an example of a control command sent using an iq stanza:
                </p>
                <p class="caption"><a name="example-2"></a>Example 2. IQ stanza for setting a value</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='set'
       from='master@clayster.com/amr'
       to='digital.output@clayster.com'
       id='1'&gt;
      &lt;set xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
         &lt;boolean name='Output' value='true'/&gt;
      &lt;/set&gt;
   &lt;/iq&gt;
   
   &lt;iq type='result'
       from='digital.output@clayster.com'
       to='master@clayster.com/amr'
       id='1'&gt;
      &lt;setResponse xmlns='urn:xmpp:iot:control' responseCode='OK'/&gt;
   &lt;/iq&gt;
                </pre>
        </div>
                <p class="" style="">
                    In the following use cases, often a message stanza will be used to illustrate the point. However, the same operation could equally well be used using an iq stanza instead.
                </p>
            </div>
            <div class="indent">
        <h3>3.1.3 <a name="sect-ID0E6NAC">Control failure response</a></h3>
                <p class="" style="">
                    By using an IQ stanza, the caller can receive an acknowledgement of the reception of the command, or error information if the command could not be processed.
                    Following is an example of a control command sent using an iq stanza, where the receiver reports an error back to the caller:
                </p>
                <p class="caption"><a name="example-3"></a>Example 3. Control failure response</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='set'
       from='master@clayster.com/amr'
       to='analog.output@clayster.com'
       id='2'&gt;
      &lt;set xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
         &lt;boolean name='Output' value='true'/&gt;
      &lt;/set&gt;
   &lt;/iq&gt;
   
   &lt;iq type='error'
       from='analog.output@clayster.com'
       to='master@clayster.com/amr'
       id='2'&gt;
      &lt;setResponse xmlns='urn:xmpp:iot:control' responseCode='OtherError'&gt;
          &lt;error var='Output'&gt;Invalid parameter type.&lt;/error&gt;
      &lt;/setResponse&gt;
   &lt;/iq&gt;
                </pre>
        </div>
            </div>
        </div>
        <div class="indent">
      <h3>3.2 <a name="sect-ID0EMOAC">Setting control parameters</a></h3>
            <p class="" style="">
                The following sub-sections illustrate how to set parameters of different types in a device.
            </p>
            <div class="indent">
        <h3>3.2.1 <a name="sect-ID0EUOAC">Setting a single boolean-valued control parameter</a></h3>
                <p class="" style="">
                    Setting single boolean-valued control parameters is a common use case, for instance when controlling digital outputs. The following example shows how a boolean value
                    can be set in a device.
                </p>
                <p class="caption"><a name="example-4"></a>Example 4. Setting a single boolean-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='digital.output@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;boolean name='Output' value='true'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.2 <a name="sect-ID0EAPAC">Setting a single 32-bit integer-valued control parameter</a></h3>
                <p class="" style="">
                    Setting single integer-valued control parameters is a common use case, for instance when controlling analog outputs. The following example shows how a 32-bit integer value
                    can be set in a device.
                </p>
                <p class="caption"><a name="example-5"></a>Example 5. Setting a single 32-bit integer-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='analog.output@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;int name='Output' value='50000'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.3 <a name="sect-ID0EMPAC">Setting a single 64-bit integer-valued control parameter</a></h3>
                <p class="" style="">
                    Setting single integer-valued control parameters is a common use case, for instance when controlling analog outputs. Even though 32-bit integers may cover most control needs,
                    it might in some cases be limiting. Therefore, a 64-bit control parameters can be created. The following example shows how a 64-bit integer value
                    can be set in a device.
                </p>
                <p class="caption"><a name="example-6"></a>Example 6. Setting a single 64-bit integer-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='megaprecision.analog.output@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;long name='Output' value='500000000000000'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.4 <a name="sect-ID0EYPAC">Setting a single string-valued control parameter</a></h3>
                <p class="" style="">
                    Setting single string-valued control parameters is a common use case, for instance when controlling text displays. The following example shows how a string value
                    can be set in a device.
                </p>
                <p class="caption"><a name="example-7"></a>Example 7. Setting a single string-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='text.display@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;string name='Row1' value='Temperature: 21.4 °C'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.5 <a name="sect-ID0EFAAE">Setting a single double-valued control parameter</a></h3>
                <p class="" style="">
                    Setting single double-valued control parameters can be an alternative form of controlling analog outputs for instance. The following example shows how a double value
                    can be set in a device.
                </p>
                <p class="caption"><a name="example-8"></a>Example 8. Setting a single double-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='analog.output2@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;double name='4-20mA' value='8.192'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.6 <a name="sect-ID0ERAAE">Setting a single date-valued control parameter</a></h3>
                <p class="" style="">
                    Setting date-valued control parameters might be necessary when timing is an issue. Often it forms part of a larger context.
                    The following example shows how a date value can be set in a device.
                </p>
                <p class="caption"><a name="example-9"></a>Example 9. Setting a single date-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='alarm@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;date name='TariffStartDate' value='2013-05-01'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.7 <a name="sect-ID0E4AAE">Setting a single time-valued control parameter</a></h3>
                <p class="" style="">
                    Setting time-valued control parameters might be necessary when timing is an issue. Often it forms part of a larger context.
                    The following example shows how a time value can be set in a device.
                </p>
                <p class="caption"><a name="example-10"></a>Example 10. Setting a single time-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='alarm@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;time name='Alarm Time' value='08:00:00'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.8 <a name="sect-ID0EJBAE">Setting a single date &amp; time-valued control parameter</a></h3>
                <p class="" style="">
                    Setting date &amp; time-valued control parameters might be necessary when timing is an issue. Often it forms part of a larger context.
                    The following example shows how a date &amp; time value can be set in a device.
                </p>
                <p class="caption"><a name="example-11"></a>Example 11. Setting a single date &amp; time-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='alarm@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;dateTime name='Alarm Time' value='2013-04-02T08:00:00'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.9 <a name="sect-ID0EVBAE">Setting a single time-valued control parameter</a></h3>
                <p class="" style="">
                    Setting time-valued control parameters might be necessary when timing is an issue. Often it forms part of a larger context.
                    The following example shows how a time value can be set in a device.
                </p>
                <p class="caption"><a name="example-12"></a>Example 12. Setting a single time-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='alarm@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;time name='Alarm Time' value='08:00:00'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.10 <a name="sect-ID0EBCAE">Setting a single duration-valued control parameter</a></h3>
                <p class="" style="">
                    Setting duration-valued control parameters might be necessary when timing is an issue. Often it forms part of a larger context.
                    The following example shows how a duration value can be set in a device.
                </p>
                <p class="caption"><a name="example-13"></a>Example 13. Setting a single duration-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='alarm@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;duration name='Alarm Duration' value='PT3M30S'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.11 <a name="sect-ID0ENCAE">Setting a single color-valued control parameter</a></h3>
                <p class="" style="">
                    Setting single color values in a device can occur in instances where color or lighting is important. Sometimes color is set using enumerations (string-valued
                    or integer-valued parameters), and sometimes as a color property. The following example shows how a color value can be set in a device.
                </p>
                <p class="caption"><a name="example-14"></a>Example 14. Setting a single color-valued control parameter</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='spotlight@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;color name='Color' value='3399FF'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.2.12 <a name="sect-ID0EZCAE">Setting multiple control parameters at once</a></h3>
                <p class="" style="">
                    Often, setting a single control parameter is not sufficient for a control action. In these cases, setting multiple control parameters at once is necessary.
                    The <span class="strong">set</span> command makes this easy however, since it allows for any number of control parameters to be set at once, as the following example shows:
                </p>
                <p class="caption"><a name="example-15"></a>Example 15. Setting multiple control parameters at once</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='dimmer@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;int name='FadeTimeMilliseconds' value='500'/&gt;
         &lt;int name='OutputPercent' value='10'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
                <p class="" style="">
                    Sometimes the order of control parameters are important in the device, and sometimes the parameters form part of a whole. It depends on the context of the device.
                    In the above example, the order is important. When the OutputPercent control parameter is set, it will start to fade in or out to the desired setting (10%), using the
                    fade time set previously. If the FadeTimeMilliseconds control parameter would have been set after the OutputPercent parameter, the fading would have been started using
                    the previous setting, which might be unknown.
                </p>
                <p class="" style="">
                    The order of control parameters to use depends on the device. The <a href="#controlform">Control Form</a> lists available control parameters of the device in the
                    order they are expected to be sent to the device. The XEP <a href="xep-0000-IoT-Interoperability.html">xep-0000-IoT-Interoperability</a> details what control parameters
                    must be available for different interfaces, and if the order of control parameters is important.
                </p>
            </div>
        </div>
        <div class="indent">
      <h3>3.3 <a name="sect-ID0EYDAE">Control forms</a></h3>
            <div class="indent">
        <h3>3.3.1 <a name="controlform">Getting a control form</a></h3>
                <p class="" style="">
                    A client can get a control form containing available control parameters of the device. This is done using the <span class="strong">getForm</span> command,
                    as is shown in the following example:
                </p>
                <p class="caption"><a name="example-16"></a>Example 16. Getting a control form</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='get'
       from='master@clayster.com/amr'
       to='dimmer@clayster.com'
       id='3'&gt;
      &lt;getForm xmlns='urn:xmpp:iot:control' xml:lang='en'/&gt;
   &lt;/iq&gt;
   
   &lt;iq type='result'
       from='dimmer@clayster.com'
       to='master@clayster.com/amr'
       id='3'&gt;
      &lt;getFormResponse xmlns='urn:xmpp:iot:concentrators' result='OK'&gt;
          &lt;x type='form' 
             xmlns='jabber:x:data' 
             xmlns:xdv='http://jabber.org/protocol/xdata-validate'
             xmlns:xdl:='http://jabber.org/protocol/xdata-layout'
             xmlns:xdd:='http://jabber.org/protocol/xdata-dynamic'&gt;
              &lt;title&gt;Dimmer&lt;/title&gt;
              &lt;xdl:page label='Output'&gt;
                  &lt;xdl:fieldref var='FaceTimeMilliseconds'/&gt;
                  &lt;xdl:fieldref var='OutputPercent'/&gt;
                  &lt;xdl:fieldref var='MainSwitch'/&gt;
              &lt;/xdl:page&gt;
              &lt;field var='xdd session' type='hidden'&gt;
                  &lt;value&gt;325ED0F3-9A9A-45A4-9634-4E0D41C5EA06&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='FadeTimeMilliseconds' type='text-single' label='Fade Time (ms):'&gt;
                  &lt;desc&gt;Time in milliseconds used to fade the light to the desired level.&lt;/desc&gt;
                  &lt;value&gt;300&lt;/value&gt;
                  &lt;xdv:validate datatype='xs:int'&gt;
                      &lt;xdv:range min='0' max='4095'/&gt;
                  &lt;/xdv:validate&gt;
                  &lt;xdd:notSame/&gt;
              &lt;/field&gt;
              &lt;field var='OutputPercent' type='text-single' label='Output (%):'&gt;
                  &lt;desc&gt;Dimmer output, in percent.&lt;/desc&gt;
                  &lt;value&gt;100&lt;/value&gt;
                  &lt;xdv:validate datatype='xs:int'&gt;
                      &lt;xdv:range min='0' max='100'/&gt;
                  &lt;/xdv:validate&gt;
                  &lt;xdd:notSame/&gt;
              &lt;/field&gt;
              &lt;field var='MainSwitch' type='boolean' label='Main switch'&gt;
                  &lt;desc&gt;If the dimmer is turned on or off.&lt;/desc&gt;
                  &lt;value&gt;true&lt;/value&gt;
                  &lt;xdd:notSame/&gt;
              &lt;/field&gt;
          &lt;/x&gt;
      &lt;/getFormResponse&gt;
   &lt;/iq&gt;
                </pre>
        </div>
                <p class="" style="">
                    <span class="strong">IMPORTANT:</span> The device MUST mark all control parameters in the form as <span class="strong">notSame</span>, as defined in
                     [<a href="#nt-ID0ESEAE">8</a>]. If an end user would open the control form and press OK (submitting the form) without having entered a value, no value
                    would be written, and no action taken. If only a few parameter would be edited, only those parameters would be sent to the device
                    and only the corresponding actions taken.
                </p>
                <p class="" style="">
                    All parameters in the form MUST also have validation rules defined according to <a href="http://xmpp.org/extensions/xep-0122.html">XEP-0122</a>, 
                    specifically validation data types and ranges where appropriate. This to give type information to the client, which the client later can use to send 
                    typed control commands directly, without the need to get and send data forms to the device to control it.
                </p>
                <p class="" style="">
                    Also, the device SHOULD group control parameters that should be written together using pages and sections, as described in
                    <a href="http://xmpp.org/extensions/xep-0141.html">XEP-0141</a>. Parameters
                    MUST also be ordered in a way so that when set in that order using the typed commands, the corresponding control actions can be successfully executed.
                </p>
                <p class="" style="">
                    <span class="strong">Note:</span> There's a difference between node parameters, as described in XEP-0326 
					<a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a>,
                    and control parameters as described in this document. For more information about this, please see
                    <a href="#nodeparamsvscontrolparams">Difference between node parameters and node control parameters</a>.
                </p>
            </div>
            <div class="indent">
        <h3>3.3.2 <a name="sect-ID0EXFAE">Getting a control form, Failure</a></h3>
                <p class="" style="">
                    A device can reject a control form request. It does this returning an <span class="strong">error</span> iq stanza, and detailing the error in the <span class="strong">result</span>
                    attribute of the <span class="strong">getFormResponse</span> element, as is shown in the following example:
                </p>
                <p class="caption"><a name="example-17"></a>Example 17. Getting a control form, Failure</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='get'
       from='master@clayster.com/amr'
       to='dimmer@clayster.com'
       id='4'&gt;
      &lt;getForm xmlns='urn:xmpp:iot:control' xml:lang='en'/&gt;
   &lt;/iq&gt;
   
   &lt;iq type='error'
       from='dimmer@clayster.com'
       to='master@clayster.com/amr'
       id='4'&gt;
      &lt;getFormResponse xmlns='urn:xmpp:iot:concentrators' result='InsufficientPrivileges'/&gt;
   &lt;/iq&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.3.3 <a name="sect-ID0EKGAE">Setting a (partial) control form</a></h3>
                <p class="" style="">
                    Control actions can be requested by submitting a full or partial control form back to the device. Control parameters not edited MUST not be included
                    in the form, and the device in turn MUST ONLY invoke control actions corresponding to the parameters returned in the form.
                </p>
                <p class="" style="">
                    The following example shows how control actions can be requested submitting a control parameters form to the device:
                </p>
                <p class="caption"><a name="example-18"></a>Example 18. Setting a (partial) control form</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='set'
       from='master@clayster.com/amr'
       to='dimmer@clayster.com'
       id='5'&gt;
      &lt;set xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
          &lt;x type='submit' xmlns='jabber:x:data'&gt;
              &lt;field var='xdd session' type='hidden'&gt;
                  &lt;value&gt;325ED0F3-9A9A-45A4-9634-4E0D41C5EA06&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='FadeTimeMilliseconds' type='text-single'&gt;
                  &lt;value&gt;500&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='OutputPercent' type='text-single'&gt;
                  &lt;value&gt;10&lt;/value&gt;
              &lt;/field&gt;
          &lt;/x&gt;
      &lt;/set&gt;
   &lt;/iq&gt;
   
   &lt;iq type='result'
       from='dimmer@clayster.com'
       to='master@clayster.com/amr'
       id='5'&gt;
      &lt;setResponse xmlns='urn:xmpp:iot:control' responseCode='OK'/&gt;
   &lt;/iq&gt;
                </pre>
        </div>
                <p class="" style="">
                    In this example, the FadeTimeMilliseconds and OutputPercent control parameters are sent, while the MainSwitch control parameter is left as is. Fading is therefore
                    parformed only if the dimmer is switched on.
                </p>
            </div>
            <div class="indent">
        <h3>3.3.4 <a name="sect-ID0E5GAE">Setting a (partial) control form, Failure</a></h3>
                <p class="" style="">
                    A device can reject a control form submission. It does this returning an <span class="strong">error</span> iq stanza, and detailing the error in the <span class="strong">result</span>
                    attribute of the <span class="strong">setResponse</span> element. If there are errors in the form, details are listed using <span class="strong">error</span> elements in the response,
                    as is shown in the following example:
                </p>
                <p class="caption"><a name="example-19"></a>Example 19. Setting a (partial) control form, Failure</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='set'
       from='master@clayster.com/amr'
       to='dimmer@clayster.com'
       id='6'&gt;
      &lt;set xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
          &lt;x type='submit' xmlns='jabber:x:data'&gt;
              &lt;field var='xdd session' type='hidden'&gt;
                  &lt;value&gt;325ED0F3-9A9A-45A4-9634-4E0D41C5EA06&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='FadeTimeMilliseconds' type='text-single'&gt;
                  &lt;value&gt;500&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='OutputPercent' type='text-single'&gt;
                  &lt;value&gt;200&lt;/value&gt;
              &lt;/field&gt;
          &lt;/x&gt;
      &lt;/set&gt;
   &lt;/iq&gt;
   
   &lt;iq type='error'
       from='dimmer@clayster.com'
       to='master@clayster.com/amr'
       id='6'&gt;
      &lt;setResponse xmlns='urn:xmpp:iot:control' responseCode='FormError'&gt;
          &lt;error var='OutputPercent'&gt;Invalid parameter value.&lt;/error&gt;
      &lt;/setResponse&gt;
   &lt;/iq&gt;
                </pre>
        </div>
            </div>
        </div>
        <div class="indent">
      <h3>3.4 <a name="sect-ID0EUHAE">Controlling devices behind a concentrator</a></h3>
            <p class="" style="">
                Controlling devices behind a concentrator can be done by specifying what device(s) to control using <span class="strong">node</span> elements within the
                command elements sent to the concentrator. The following sub-sections show examples of how this is done.
            </p>
            <div class="indent">
        <h3>3.4.1 <a name="sect-ID0E6HAE">Sending a control command to a node behind a concentrator</a></h3>
                <p class="" style="">
                    To send a control message to a specific node behind a concentrator, the <span class="strong">node</span> element can be used to identify the node,
                    as is shown in the following example:
                </p>
                <p class="caption"><a name="example-20"></a>Example 20. Sending a control command to a node behind a concentrator</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='concentrator@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;node nodeId='DigitalOutput1'/&gt;
         &lt;boolean name='Output' value='false'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.4.2 <a name="sect-ID0EOIAE">Sending a control command to multiple nodes</a></h3>
                <p class="" style="">
                    The client can send the same control command to multiple nodes behind a concentrator by simply adding more <span class="strong">node</span> elements in the request,
                    as is shown in the following example:
                </p>
                <p class="caption"><a name="example-21"></a>Example 21. Sending a control command to multiple nodes</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;message from='master@clayster.com/amr'
            to='concentrator@clayster.com'&gt;
      &lt;set xmlns='urn:xmpp:iot:control'&gt;
         &lt;node nodeId='DigitalOutput1'/&gt;
         &lt;node nodeId='DigitalOutput2'/&gt;
         &lt;node nodeId='DigitalOutput3'/&gt;
         &lt;node nodeId='DigitalOutput4'/&gt;
         &lt;boolean name='Output' value='false'/&gt;
      &lt;/set&gt;
   &lt;/message&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.4.3 <a name="sect-ID0E4IAE">Sending a control command to multiple nodes, Failure</a></h3>
                <p class="" style="">
                    By using an IQ stanza, the caller can receive an acknowledgement of the reception of the command, or error information if the command could not be processed.
                    When sending a control command to multiple nodes at a time the device must validate all parameters against all nodes before taking any control action. If
                    validation fails, an error message is returned and no control action is taken. The following example shows an example of an erroneous control message made to
                    multiple nodes on a device:
                </p>
                <p class="caption"><a name="example-22"></a>Example 22. Sending a control command to multiple nodes, Failure</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='set'
       from='master@clayster.com/amr'
       to='concentrator@clayster.com'
       id='7'&gt;
      &lt;set xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
         &lt;node nodeId='DigitalOutput1'/&gt;
         &lt;node nodeId='DigitalOutput2'/&gt;
         &lt;node nodeId='DigitalOutput3'/&gt;
         &lt;node nodeId='DigitalOutput4'/&gt;
         &lt;node nodeId='AnalogOutput1'/&gt;
         &lt;node nodeId='AnalogOutput2'/&gt;
         &lt;node nodeId='AnalogOutput3'/&gt;
         &lt;node nodeId='AnalogOutput4'/&gt;
         &lt;boolean name='Output' value='true'/&gt;
      &lt;/set&gt;
   &lt;/iq&gt;
   
   &lt;iq type='error'
       from='concentrator@clayster.com'
       to='master@clayster.com/amr'
       id='7'&gt;
      &lt;setResponse xmlns='urn:xmpp:iot:control' responseCode='OtherError'&gt;
          &lt;error var='Output'&gt;Invalid parameter type.&lt;/error&gt;
      &lt;/setResponse&gt;
   &lt;/iq&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.4.4 <a name="sect-ID0EJJAE">Getting a control form from multiple nodes</a></h3>
                <p class="" style="">
                    A client can get a control form containing available control parameters common between a set of nodes controlled by the concentrator. This is done 
                    adding a sequence of <span class="strong">node</span> elements to a <span class="strong">getForm</span> command sent to the concentrator, as is shown in the following example:
                </p>
                <p class="caption"><a name="example-23"></a>Example 23. Getting a control form</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='get'
       from='master@clayster.com/amr'
       to='concentrator@clayster.com'
       id='8'&gt;
      &lt;getForm xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
          &lt;node nodeId='DigitalOutput1'/&gt;
          &lt;node nodeId='DigitalOutput2'/&gt;
          &lt;node nodeId='DigitalOutput3'/&gt;
          &lt;node nodeId='DigitalOutput4'/&gt;
      &lt;/getForm&gt;
   &lt;/iq&gt;
   
   &lt;iq type='result'
       from='concentrator@clayster.com'
       to='master@clayster.com/amr'
       id='8'&gt;
      &lt;getFormResponse xmlns='urn:xmpp:iot:concentrators' result='OK'&gt;
          &lt;x type='form' 
             xmlns='jabber:x:data' 
             xmlns:xdv='http://jabber.org/protocol/xdata-validate'
             xmlns:xdl:='http://jabber.org/protocol/xdata-layout'
             xmlns:xdd:='http://jabber.org/protocol/xdata-dynamic'&gt;
              &lt;title&gt;DigitalOutput1, DigitalOutput2, ...&lt;/title&gt;
              &lt;xdl:page label='Output'&gt;
                  &lt;xdl:fieldref var='Output'/&gt;
              &lt;/xdl:page&gt;
              &lt;field var='xdd session' type='hidden'&gt;
                  &lt;value&gt;325ED0F3-9A9A-45A4-9634-4E0D41C5EA06&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='Output' type='boolean' label='Output'&gt;
                  &lt;desc&gt;If the digital output is high (checked) or low (uncheckd).&lt;/desc&gt;
                  &lt;value&gt;true&lt;/value&gt;
                  &lt;xdd:notSame/&gt;
              &lt;/field&gt;
          &lt;/x&gt;
      &lt;/getFormResponse&gt;
   &lt;/iq&gt;
                </pre>
        </div>
                <p class="" style="">
                    Note that only parameters that are common between the nodes defined in the request must be returned. However, all parameters must have the
                    <span class="strong">notSame</span> flag set, regardless of current output status.
                </p>
            </div>
            <div class="indent">
        <h3>3.4.5 <a name="sect-ID0EBKAE">Getting a control form from multiple nodes, Failure</a></h3>
                <p class="" style="">
                    A device can reject a control form request. It does this returning an <span class="strong">error</span> iq stanza, and detailing the error in the <span class="strong">result</span>
                    attribute of the <span class="strong">getFormResponse</span> element. The following example shows the device rejecting a control form request, because it does not support
                    the handling of common parameters between multiple nodes:
                </p>
                <p class="caption"><a name="example-24"></a>Example 24. Getting a control form from multiple nodes, Failure</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='get'
       from='master@clayster.com/amr'
       to='concentrator@clayster.com'
       id='9'&gt;
      &lt;getForm xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
          &lt;node nodeId='DigitalOutput1'/&gt;
          &lt;node nodeId='DigitalOutput2'/&gt;
          &lt;node nodeId='DigitalOutput3'/&gt;
          &lt;node nodeId='DigitalOutput4'/&gt;
      &lt;/getForm&gt;
   &lt;/iq&gt;
   
   &lt;iq type='error'
       from='concentrator@clayster.com'
       to='master@clayster.com/amr'
       id='9'&gt;
      &lt;getFormResponse xmlns='urn:xmpp:iot:concentrators' result='NotImplemented'/&gt;
   &lt;/iq&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.4.6 <a name="sect-ID0EUKAE">Setting a (partial) control form to multiple nodes</a></h3>
                <p class="" style="">
                    You set a control form to multiple nodes controlled by a concentrator by adding <span class="strong">node</span> elements to the set
                    command sent to the concentrator, as is shown in the following example:
                </p>
                <p class="caption"><a name="example-25"></a>Example 25. Setting a (partial) control form to multiple nodes</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='set'
       from='master@clayster.com/amr'
       to='concentrator@clayster.com'
       id='10'&gt;
      &lt;set xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
          &lt;node nodeId='DigitalOutput1'/&gt;
          &lt;node nodeId='DigitalOutput2'/&gt;
          &lt;node nodeId='DigitalOutput3'/&gt;
          &lt;node nodeId='DigitalOutput4'/&gt;
          &lt;x type='submit' xmlns='jabber:x:data'&gt;
              &lt;field var='xdd session' type='hidden'&gt;
                  &lt;value&gt;325ED0F3-9A9A-45A4-9634-4E0D41C5EA06&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='Output' type='boolean'&gt;
                  &lt;value&gt;true&lt;/value&gt;
              &lt;/field&gt;
          &lt;/x&gt;
      &lt;/set&gt;
   &lt;/iq&gt;
   
   &lt;iq type='result'
       from='concentrator@clayster.com'
       to='master@clayster.com/amr'
       id='10'&gt;
      &lt;setResponse xmlns='urn:xmpp:iot:control' responseCode='OK'/&gt;
   &lt;/iq&gt;
                </pre>
        </div>
            </div>
            <div class="indent">
        <h3>3.4.7 <a name="sect-ID0EFLAE">Setting a (partial) control form to multiple nodes, Failure</a></h3>
                <p class="" style="">
                    A device can reject a control form submission. It does this returning an <span class="strong">error</span> iq stanza, and detailing the error in the <span class="strong">result</span>
                    attribute of the <span class="strong">setResponse</span> element. The following example shows the device rejecting a control form submission because one of the control parameters,
                    even though it exists on all nodes, is not of the same type on all nodes.
                </p>
                <p class="caption"><a name="example-26"></a>Example 26. Setting a (partial) control form to multiple nodes</p>
        <div class="indent">
          <pre class="prettyprint">
                    
   &lt;iq type='set'
       from='master@clayster.com/amr'
       to='concentrator@clayster.com'
       id='11'&gt;
      &lt;set xmlns='urn:xmpp:iot:control' xml:lang='en'&gt;
          &lt;node nodeId='DigitalOutput1'/&gt;
          &lt;node nodeId='DigitalOutput2'/&gt;
          &lt;node nodeId='DigitalOutput3'/&gt;
          &lt;node nodeId='DigitalOutput4'/&gt;
          &lt;node nodeId='AnalogOutput1'/&gt;
          &lt;node nodeId='AnalogOutput2'/&gt;
          &lt;node nodeId='AnalogOutput3'/&gt;
          &lt;node nodeId='AnalogOutput4'/&gt;
          &lt;x type='submit' xmlns='jabber:x:data'&gt;
              &lt;field var='xdd session' type='hidden'&gt;
                  &lt;value&gt;325ED0F3-9A9A-45A4-9634-4E0D41C5EA06&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='Output' type='boolean'&gt;
                  &lt;value&gt;true&lt;/value&gt;
              &lt;/field&gt;
          &lt;/x&gt;
      &lt;/set&gt;
   &lt;/iq&gt;
   
   &lt;iq type='result'
       from='concentrator@clayster.com'
       to='master@clayster.com/amr'
       id='11'&gt;
      &lt;setResponse xmlns='urn:xmpp:iot:control' responseCode='FormError'&gt;
          &lt;error var='Output'&gt;Invalid type&lt;/error&gt;
      &lt;/setResponse&gt;
   &lt;/iq&gt;
                </pre>
        </div>
            </div>
        </div>
    <h2>4.
       <a name="support">Determining Support</a></h2>
		<p class="" style="">If an entity supports the protocol specified herein, it MUST advertise that fact by returning a feature of "urn:xmpp:iot:control" in response to <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0030.html">Service Discovery</a></span>  [<a href="#nt-ID0EIMAE">9</a>] information requests.</p>
		<p class="caption"><a name="example-27"></a>Example 27. Service discovery information request</p>
    <div class="indent">
      <pre class="prettyprint">
			
&lt;iq type='get'
    from='device@clayster.com/device'
    to='provisioning@clayster.com'
    id='disco1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
		</pre>
    </div>
		<p class="caption"><a name="example-28"></a>Example 28. Service discovery information response</p>
    <div class="indent">
      <pre class="prettyprint">
			
&lt;iq type='result'
    from='provisioning@clayster.com'
    to='device@clayster.com/device'
    id='disco1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    ...
    &lt;feature var='urn:xmpp:iot:control'/&gt;
    ...
  &lt;/query&gt;
&lt;/iq&gt;
		</pre>
    </div>
		<p class="" style="">
			In order for an application to determine whether an entity supports this protocol, where possible it SHOULD use the dynamic, presence-based profile of service discovery defined
			in <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0115.html">Entity Capabilities</a></span>  [<a href="#nt-ID0E6MAE">10</a>]. However, if an application has not received entity capabilities information from an entity, it SHOULD use explicit service discovery instead.
		</p>
	<h2>5.
       <a name="impl">Implementation Notes</a></h2>
        <div class="indent">
      <h3>5.1 <a name="sect-ID0ELNAE">Reading current control states</a></h3>
            <p class="" style="">
                If a client wants to know the current status of control parameters, it must perform a readout of <span class="strong">Momentary</span> and <span class="strong">Status</span> values 
                from the device, according to <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0323.html">Internet of Things - Sensor Data</a></span>  [<a href="#nt-ID0E4NAE">11</a>], and from the returned set of values take the current control parameter value according to the following rules, ordered by priority:
            </p>
            <ul class="" style="">
                <li class="" style="">
                    <p class="" style="">
                        If there's a field marked as momentary value, with an unlocalized field name equal to the unlocalized control parameter name and having a compatible
                        field value type (see table below) and a status field without the missing flag set, the value of the field should be considered the current value of 
                        the control parameter.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        If there's a field marked as status value, with an unlocalized field name equal to the unlocalized control parameter name and having a compatible
                        field value type (see table below) and a status field without the missing flag set, the value of the field should be considered the current value of 
                        the control parameter.
                    </p>
                </li>
            </ul>
            <p class="" style="">
                Even though getting the the control form could provide the client with a quicker and easier way of retrieving control parameter values, the form is not
                guaranteed to contain correct current values. In some cases, retrieving current values might take time and only be retrieved using an asynchronous read-out
                process described in this section.
            </p>
            <p class="" style="">
                The following table shows how corresponding field values should be converted to the corresponding control parameter value based on field type (x-axis) and 
                control parameter type (y-axis). N/A means conversion has no meaning and types are not compatible.
            </p>
            <div class="indent">
        <p class="caption"><a name="table-2"></a>Table 2: Conversion of Field Value to Control Parameter Value based on types</p>
        <table border="1" cellpadding="3" cellspacing="0">
                <tr class="body">
                    <th colspan="" rowspan=""></th>
                    <th colspan="" rowspan="">numeric</th>
                    <th colspan="" rowspan="">string</th>
                    <th colspan="" rowspan="">boolean</th>
                    <th colspan="" rowspan="">dateTime</th>
                    <th colspan="" rowspan="">timeSpan</th>
                    <th colspan="" rowspan="">enum</th>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">boolean</th>
                    <td colspan="" rowspan="">!=0</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">color</th>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">RRGGBB or RRGGBBAA</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">date</th>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">(1)</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">Date part</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">dateTime</th>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">(2)</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">double</th>
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">(3)</td>
                    <td colspan="" rowspan="">Z2</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">duration</th>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">(4)</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">int</th>
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">(5)</td>
                    <td colspan="" rowspan="">Z2</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">long</th>
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">(5)</td>
                    <td colspan="" rowspan="">Z2</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">string</th>
                    <td colspan="" rowspan="">(6)</td>
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">xs:boolean</td>
                    <td colspan="" rowspan="">xs:dateTime</td>
                    <td colspan="" rowspan="">xs:duration</td>
                    <td colspan="" rowspan="">x</td>
                </tr>
                <tr class="body">
                    <th colspan="" rowspan="">time</th>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">(7)</td>
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">Time part</td>
                    <td colspan="" rowspan="">(8)</td>
                    <td colspan="" rowspan="">N/A</td>
                </tr>
            </table>
      </div>
            <p class="" style="">
                The following table lists notes with details on how to do conversion, if in doubt.
            </p>
            <div class="indent">
        <p class="caption"><a name="table-3"></a>Table 3: Conversion rules</p>
        <table border="1" cellpadding="3" cellspacing="0">
                <tr class="body">
                    <th colspan="" rowspan="">Note</th>
                    <th colspan="" rowspan="">Description</th>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(1)</td>
                    <td colspan="" rowspan="">
                        The client should try to convert the string to a date value, first according to the format specified by the XML data type xs:date, and if not possible
                        by RFC 822.
                    </td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(2)</td>
                    <td colspan="" rowspan="">
                        The client should try to convert the string to a date &amp; time value, first according to the format specified by the XML data type xs:dateTime, and if not possible
                        by RFC 822.
                    </td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(3)</td>
                    <td colspan="" rowspan="">
                        The client should try to convert the string to a double-precision floating-point value, first according to the format specified by the XML data type xs:double, 
                        and if not possible using system-local string to floating-point conversion using local decimal and throusand separator settings.
                    </td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(4)</td>
                    <td colspan="" rowspan="">
                        The client should try to convert the string to a duration value, first according to the format specified by the XML data type xs:duration,
                        and if not possible using the XML data type xs:time.
                    </td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(5)</td>
                    <td colspan="" rowspan="">The client should try to convert the string to an integer value according to the corresponding XML data type formats xs:int and xs:long.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(6)</td>
                    <td colspan="" rowspan="">
                        The numeric field value consists of three parts: Numeric value, number of decimals and optional unit. If no unit is provided, only the numeric value should
                        be converted to a string (compatible with the XML data type xs:double), using exactly the number of decimals provided in the field. If a unit is provided
                        (non-empty string) it must not be appended to the value, if the value is to be used for control output. For presentation purposes however, a space could be 
                        appended to the number and the unit appended after the space.    
                    </td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(7)</td>
                    <td colspan="" rowspan="">
                        The client should try to convert the string to a time value  according to the format specified by the XML data type xs:time.
                    </td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">(8)</td>
                    <td colspan="" rowspan="">
                        A timeSpan field value contains a xs:duration value. The xs:duration has a larger domain than xs:time, and contains all xs:time values, but xs:time does
                        not contain all possible xs:duration values. So, conversion of an xs:duration value to an xs:time value should be performed only if a duration lies
                        between 00:00:00 and 23:59:59.
                    </td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">x</td>
                    <td colspan="" rowspan="">Use the canonical conversion method.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">Z2</td>
                    <td colspan="" rowspan="">true = 1, false = 0.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">N/A</td>
                    <td colspan="" rowspan="">Not applicable. Conversion has no meaning. Value types are not compatible.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">!=0</td>
                    <td colspan="" rowspan="">Nonzero = true, Zero = false.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">RRGGBB</td>
                    <td colspan="" rowspan="">A string of six hexadecimal characters, the first two the red component of the color, the next two the green component and the last two the blue component.</td>
                </tr>
				<tr class="body">
					<td colspan="" rowspan="">RRGGBBAA</td>
					<td colspan="" rowspan="">A string of eight hexadecimal characters, the first two the red component of the color, the next two the green component, the following two the blue component and the last two the alpha channel.</td>
				</tr>
				<tr class="body">
                    <td colspan="" rowspan="">Date part</td>
                    <td colspan="" rowspan="">Only the date part of the xs:dateTime value should be used.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">Time part</td>
                    <td colspan="" rowspan="">Only the time part of the xs:dateTime value should be used.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">xs:boolean</td>
                    <td colspan="" rowspan="">Conversion to a string should follow the rules specified for the XML datatype xs:boolean.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">xs:dateTime</td>
                    <td colspan="" rowspan="">Conversion to a string should follow the rules specified for the XML datatype xs:dateTime.</td>
                </tr>
                <tr class="body">
                    <td colspan="" rowspan="">xs:duration</td>
                    <td colspan="" rowspan="">Conversion to a string should follow the rules specified for the XML datatype xs:duration.</td>
                </tr>
            </table>
      </div>
            <p class="" style="">
                <span class="strong">Note:</span> the namespace prefix <span class="strong">xs</span> is here supposed to be linked with the XML Schema namespace
                <a href="http://www.w3.org/2001/XMLSchema">http://www.w3.org/2001/XMLSchema</a>.
            </p>
        </div>
        <div class="indent">
      <h3>5.2 <a name="nodeparamsvscontrolparams">Difference between node parameters and node control parameters</a></h3>
            <p class="" style="">
                A node defined in a concentrator, as defined by <a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a>, supporting control has
                two sets of parameters that are different: First a set of node parameters and then a set of control parameters.
            </p>
            <p class="" style="">
                Node parameters are defined by the node type in the concentrator, as described in <a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a>,
                and they are typically used by the concentrator to define the node and how to communicate or interact with the underlying device. The important part here is to know
                that the node parameters are maintained by the concentrator, not the underlying device.
            </p>
            <p class="" style="">
                Control parameters however, are parameters that reside on the underlying device. When set, they change the actual state or behaviour of the underlying device.
                The connection to the device however, controlled by the concentrator, remains unchanged by such a control parameter update.
            </p>
        </div>
        <div class="indent">
      <h3>5.3 <a name="parametergroups">Grouping control parameters</a></h3>
            <p class="" style="">
                Many control actions avilable in a device can be controlled using only one control parameter. If a device only publishes such control parameters, the order
                of control paramters is not that important.
            </p>
            <p class="" style="">
                However, there are many control actions that require the client to set multiple control parameters at the same time, for the device to have a complete understanding
                what the client wants to do.
            </p>
            <p class="" style="">
                <a href="http://xmpp.org/extensions/xep-0141.html">XEP-0141</a> defines a way to group parameters in a data form by including the concept of pages and sections.
                Even though these pages and sections are used for layout purposes, it should be used by devices to mark parameters that should be used together to perform control actions.
            </p>
            <p class="" style="">
                The following set of rules should be adhered to, by devices as well as clients, to minimize confusion and resulting errors:
            </p>
            <ul class="" style="">
                <li class="" style="">
                    <p class="" style="">
                        Control parameters should be listed in control forms in the order the device expects the client to write them back.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        Clients should set control parameters in the order they are listed in the corresponding control forms.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        Control actions that require multiple control parameters should report these together, grouped by pages or sections within pages,
                        to make clear that the parameters belong together.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        For control actions requiring multiple control parameters, devices should strive to publish default values for all parameters involved. 
                        These default values should then be used by the device if a client happens to write only a subset of the control parameters required for
                        a control action. The default value could be the current state of the parameter.
                    </p>
                </li>
            </ul>
            <p class="" style="">
                Note however, that one cannot always make the assumption that parameters on the same page or same section in a control form belong to the same control action.
                For instance, a PLC with 16 digital outputs might publish a control form containing a single page with 16 check boxes on (boolean parameters), that can be
                controlled individually.
            </p>
            <p class="" style="">
                To solve the problem of grouping parameters together, so a client can know which parameters belong together, a new element is defined that can be used in
                data forms: <span class="strong">parameterGroup</span>. It is optional, but can be added to control parameters in forms, as a way to tell the client that parameters
                having the same <span class="strong">parameterGroup</span> belong together and should be written together.
            </p>
			<p class="" style="">
				<span class="strong">Note:</span> If used, the server must not include a parameter in more than one parameter group at a time. The form may contain multiple group, but each 
				parameter must only have at most one <span class="strong">parameterGroup</span> element.
			</p>
			<p class="" style="">
				The following example illustrates the use of the <span class="strong">parameterGroup</span> element to group parameters together.
			</p>
            <p class="caption"><a name="example-29"></a>Example 29. Grouping control parameters</p>
      <div class="indent">
        <pre class="prettyprint">
                
   &lt;iq type='get'
       from='master@clayster.com/amr'
       to='spotlight@clayster.com'
       id='12'&gt;
      &lt;getForm xmlns='urn:xmpp:iot:control' xml:lang='en'/&gt;
   &lt;/iq&gt;
   
   &lt;iq type='result'
       from='spotlight@clayster.com'
       to='master@clayster.com/amr'
       id='12'&gt;
      &lt;getFormResponse xmlns='urn:xmpp:iot:concentrators' result='OK'&gt;
          &lt;x type='form' 
             xmlns='jabber:x:data' 
             xmlns:xdv='http://jabber.org/protocol/xdata-validate'
             xmlns:xdl:='http://jabber.org/protocol/xdata-layout'
             xmlns:xdd:='http://jabber.org/protocol/xdata-dynamic'&gt;
              &lt;title&gt;Spotlight&lt;/title&gt;
              &lt;xdl:page label='Output'&gt;
                  &lt;xdl:fieldref var='MainSwitch'/&gt;
              &lt;/xdl:page&gt;
              &lt;xdl:page label='Direction'&gt;
                  &lt;xdl:fieldref var='HorizontalAngle'/&gt;
                  &lt;xdl:fieldref var='ElevationAngle'/&gt;
              &lt;/xdl:page&gt;
              &lt;field var='xdd session' type='hidden'&gt;
                  &lt;value&gt;325ED0F3-9A9A-45A4-9634-4E0D41C5EA06&lt;/value&gt;
              &lt;/field&gt;
              &lt;field var='MainSwitch' type='boolean' label='Main switch'&gt;
                  &lt;desc&gt;If the spotlight is turned on or off.&lt;/desc&gt;
                  &lt;value&gt;true&lt;/value&gt;
                  &lt;xdd:notSame/&gt;
              &lt;/field&gt;
              &lt;field var='HorizontalAngle' type='text-single' label='Horizontal angle:'&gt;
                  &lt;desc&gt;Horizontal angle of the spotlight.&lt;/desc&gt;
                  &lt;value&gt;0&lt;/value&gt;
                  &lt;xdv:validate datatype='xs:double'&gt;
                      &lt;xdv:range min='-180' max='180'/&gt;
                  &lt;/xdv:validate&gt;
                  &lt;xdd:notSame/&gt;
                  &lt;parameterGroup xmlns='urn:xmpp:iot:control' name='direction'/&gt;
              &lt;/field&gt;
              &lt;field var='ElevationAngle' type='text-single' label='Elevation angle:'&gt;
                  &lt;desc&gt;Elevation angle of the spotlight.&lt;/desc&gt;
                  &lt;value&gt;0&lt;/value&gt;
                  &lt;xdv:validate datatype='xs:double'&gt;
                      &lt;xdv:range min='-90' max='90'/&gt;
                  &lt;/xdv:validate&gt;
                  &lt;xdd:notSame/&gt;
                  &lt;parameterGroup xmlns='urn:xmpp:iot:control' name='direction'/&gt;
              &lt;/field&gt;
          &lt;/x&gt;
      &lt;/getFormResponse&gt;
   &lt;/iq&gt;
            </pre>
      </div>
            <p class="" style="">
                The above example informs the client that the two parameters HorizontalAngle and ElevationAngle should be written together to control a control action
                (named direction).
            </p>
            <p class="" style="">
                For more information about common control actions and their parameters, see <a href="xep-0000-IoT-Interoperability.html">xep-0000-IoT-Interoperability.html</a>,
                which defines a set of interoperable interfaces and their abilities.
            </p>
        </div>
        <div class="indent">
      <h3>5.4 <a name="sect-ID0EVFAG">Node commands vs. control parameters</a></h3>
            <p class="" style="">
                Nodes behind a concentrator, as defined in <a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a>, have an additional means of
                publishing control interfaces: Node Commands.
            </p>
            <p class="" style="">
                However, there are many differences between Node Commands and Control Parameters, as shown in the following list:
            </p>
            <ul class="" style="">
                <li class="" style="">
                    <p class="" style="">
                        Node Commands are defined by the node type in the concentrator, and not by the device itself.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        Node Commands may do many different things, not only performing control actions.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        Parametrized Node Commands require the client to always get a parameter data form, and write back values. There's no way to send simple
                        control messages using Node Commands.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        Node Commands can be partitioned, grouped and sorted separately.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        Each Parametrized Node Command has a separate parameter form, which makes grouping of parameters normal.
                    </p>
                </li>
                <li class="" style="">
                    <p class="" style="">
                        Node Commands are only available for nodes controlled by a concentrator.
                    </p>
                </li>
            </ul>
            <p class="" style="">
                If implementing a device with many complex control actions (like an advanced PLC), consideration should be made to divide the device into logical groups and
                implement the concentrators interface as well. Then the more complex control actions could be implemented as Node Commands instead of control actions
                as defined in this document, and implementing the simpler more intuitive control actions as described in this document.
            </p>
        </div>
        <div class="indent">
      <h3>5.5 <a name="sect-ID0EFIAG">Tokens</a></h3>
            <p class="" style="">
                If control interaction is performed in a context of delegated trust, as defined in the Sensor Network Provisioning XEP-0324 <span class="ref" style=""><a href="http://xmpp.org/extensions/xep-0324.html">Internet of Things - Provisioning</a></span>  [<a href="#nt-ID0ETIAG">12</a>], 
				tokens should always be included in all calls. This to allow devices to check privileges with provisioning servers.
            </p>
            <p class="" style="">
                The <span class="strong">set</span> and <span class="strong">getForm</span> commands support the following token attributes:
            </p>
            <ul class="" style="">
                <li class="" style="">
                    <span class="strong">serviceToken</span>
                </li>
                <li class="" style="">
                    <span class="strong">deviceToken</span>
                </li>
                <li class="" style="">
                    <span class="strong">userToken</span>
                </li>
            </ul>
            <p class="" style="">
                For more information about provisioning, see <a href="http://xmpp.org/extensions/xep-0324.html">Internet of Things - Provisioning</a>.
            </p>
        </div>
        <div class="indent">
      <h3>5.6 <a name="sect-ID0EGKAG">Controlling devices in large subsystems</a></h3>
            <p class="" style="">
				Most examples in this document have been simplified examples where a few devices containing a few control parameters have been used. However, in many cases large subsystems with
				very many actuators containing many different control actions have to be controlled, as is documented in
				<a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a>. 
                In such cases, a node may have to be specified using two or perhaps even three ID's: a <span class="strong">sourceId</span> identifying the data source controlling the device, a possible 
                <span class="strong">cacheType</span> narrowing down the search to a specific kind of node, and the common <span class="strong">nodeId</span>. For more information about this, see 
                <a href="http://xmpp.org/extensions/xep-0326.html">Internet of Things - Concentrators</a>.
            </p>
            <p class="" style="">
                <span class="strong">Note:</span> For cases where the <span class="strong">nodeId</span> is sufficient to uniquely identify the node, it is sufficient to provide this attribute in the request.
                If there is ambiguity in the request, the receptor must treat the request as a request with a set of nodes, all with the corresponding <span class="strong">nodeId</span> as requested.
            </p>
        </div>
    <h2>6.
       <a name="i18n">Internationalization Considerations</a></h2>
        <div class="indent">
      <h3>6.1 <a name="sect-ID0EMLAG">Time Zones</a></h3>
            <p class="" style="">
                All timestamps and dateTime values use the XML data type xs:dateTime to specify values. These values include a date, an optional time and an optional time zone.
            </p>
            <p class="" style="">
                <span class="strong">Note:</span> If time zone is not available, it is supposed to be undefined. The client reading the sensor that reports fields without time zone information
                should assume the sensor has the same time zone as the client, if not explicitly configured otherwise on the client side.
            </p>
            <p class="" style="">
                If devices report time zone, this information should be propagated throughout the system. Otherwise, comparing timestamps from different time zones will be impossible.
            </p>
        </div>
        <div class="indent">
      <h3>6.2 <a name="sect-ID0EAMAG">xml:lang</a></h3>
            <p class="" style="">
                Control commands sent using IQ stanzas instead of messages, should consider using the <span class="strong">xml:lang</span> attribute to specify the desired language
                used (if possible) when returning information back to the caller, like error messages, localized control forms, etc.
            </p>
        </div>
    <h2>7.
       <a name="security">Security Considerations</a></h2>
        <p class="" style="">
            Controlling devices in a large sensor network is a hackers wet dream. Therefore, consideration of how network security is implemented should not be underestimated.
            The following sections provide some general items that should be considered.
        </p>
        <div class="indent">
      <h3>7.1 <a name="sect-ID0EVMAG">Encryption &amp; Authentication</a></h3>
            <p class="" style="">
                Consider to always use an encrypted connection with any XMPP Server used in the network. Also, make sure the server is properly authenticated and any server
                certificate properly validated.
            </p>
            <p class="" style="">
                Control commands should only be accepted by trusted parties. A minimum is to make sure only authenticated and validated clients (friends) can perform control actions
                on the device.
            </p>
        </div>
        <div class="indent">
      <h3>7.2 <a name="sect-ID0ECNAG">Provisioning</a></h3>
            <p class="" style="">
                Consider using provisioning servers to allow for detailed control of who can do what in a sensor network. Implementing proper provisioning support decreases
                the risk for adverse effects, not only from intentional hacking, but also from unintentional errors.
            </p>
            <p class="" style="">
                If using delegated trust, make sure the provisioning servers are properly authenticated and validated before trusting them.
            </p>
            <p class="" style="">
                More information about provisioning can be found in <a href="http://xmpp.org/extensions/xep-0324.html">Internet of Things - Provisioning</a>.
            </p>
        </div>
    <h2>8.
       <a name="iana">IANA Considerations</a></h2>
        <p class="" style="">This document requires no interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-ID0EGOAG">13</a>].</p>
    <h2>9.
       <a name="registrar">XMPP Registrar Considerations</a></h2>
		<p class="" style="">
			The <a href="#schema">protocol schema</a> needs to be added to the list of <a href="http://xmpp.org/resources/schemas/">XMPP protocol schemas</a>.
		</p>
	<h2>10.
       <a name="schema">XML Schema</a></h2>
        <p class="caption">
    </p>
    <div class="indent">
      <pre class="prettyprint">
            
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:iot:control'
    xmlns='urn:xmpp:iot:control'
    xmlns:sn='urn:xmpp:iot:sensordata'
    xmlns:xd="jabber:x:data"
    xmlns:xdv="http://jabber.org/protocol/xdata-validate"
    xmlns:xdl="http://jabber.org/protocol/xdata-layout"
    elementFormDefault='qualified'&gt;
 
    &lt;xs:import namespace='urn:xmpp:iot:sensordata'/&gt;
    &lt;xs:import namespace='jabber:x:data'/&gt;
    &lt;xs:import namespace='http://jabber.org/protocol/xdata-validate'/&gt;
    &lt;xs:import namespace='http://jabber.org/protocol/xdata-layout'/&gt;
 
    &lt;xs:element name='set'&gt;
        &lt;xs:complexType&gt;
            &lt;xs:choice minOccurs='0' maxOccurs='unbounded'&gt;
                &lt;xs:element name='node' type='NodeReference'/&gt;
                &lt;xs:element name='boolean' type='BooleanParameter'/&gt;
                &lt;xs:element name='color' type='ColorParameter'/&gt;
                &lt;xs:element name='date' type='DateParameter'/&gt;
                &lt;xs:element name='dateTime' type='DateTimeParameter'/&gt;
                &lt;xs:element name='double' type='DoubleParameter'/&gt;
                &lt;xs:element name='duration' type='DurationParameter'/&gt;
                &lt;xs:element name='int' type='IntParameter'/&gt;
                &lt;xs:element name='long' type='LongParameter'/&gt;
                &lt;xs:element name='string' type='StringParameter'/&gt;
                &lt;xs:element name='time' type='TimeParameter'/&gt;
                &lt;xs:element ref='xd:x'/&gt;
            &lt;/xs:choice&gt;
            &lt;xs:attributeGroup ref='tokens'/&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
 
    &lt;xs:element name='setResponse'&gt;
        &lt;xs:complexType&gt;
            &lt;xs:choice minOccurs='0' maxOccurs='unbounded'&gt;
                &lt;xs:element name='node' type='NodeReference'/&gt;
                &lt;xs:element name='error' type='ParameterError'/&gt;
            &lt;/xs:choice&gt;
            &lt;xs:attributeGroup ref='responseCode'/&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
 
    &lt;xs:element name='getForm'&gt;
        &lt;xs:complexType&gt;
            &lt;xs:sequence minOccurs='0' maxOccurs='unbounded'&gt;
                &lt;xs:element name='node' type='NodeReference'/&gt;
            &lt;/xs:sequence&gt;
            &lt;xs:attributeGroup ref='tokens'/&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
 
    &lt;xs:element name='getFormResponse'&gt;
        &lt;xs:complexType&gt;
            &lt;xs:sequence&gt;
                &lt;xs:element ref='xd:x' minOccurs="0" maxOccurs="1"/&gt;
            &lt;/xs:sequence&gt;
            &lt;xs:attributeGroup ref='responseCode'/&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
 
    &lt;xs:element name='parameterGroup'&gt;
        &lt;xs:complexType&gt;
            &lt;xs:attribute name='name' type='xs:string' use='required'/&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
 
    &lt;xs:attributeGroup name='nodeReference'&gt;
        &lt;xs:attribute name='nodeId' type='xs:string' use='required'/&gt;
        &lt;xs:attribute name='sourceId' type='xs:string' use='optional'/&gt;
        &lt;xs:attribute name='cacheType' type='xs:string' use='optional'/&gt;
    &lt;/xs:attributeGroup&gt;
 
    &lt;xs:attributeGroup name='tokens'&gt;
        &lt;xs:attribute name='serviceToken' type='xs:string' use='optional'/&gt;
        &lt;xs:attribute name='deviceToken' type='xs:string' use='optional'/&gt;
        &lt;xs:attribute name='userToken' type='xs:string' use='optional'/&gt;
    &lt;/xs:attributeGroup&gt;
 
    &lt;xs:attributeGroup name='responseCode'&gt;
        &lt;xs:attribute name='result' type='ResponseCode' use='required'/&gt;
    &lt;/xs:attributeGroup&gt;
 
    &lt;xs:complexType name='Parameter' abstract='true'&gt;
        &lt;xs:attribute name='name' type='xs:string' use='required'/&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='BooleanParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:boolean' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='ColorParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='Color' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='DateParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:date' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='DateTimeParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:dateTime' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='DoubleParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:double' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='DurationParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:duration' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='IntParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:int' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='LongParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:long' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='StringParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:string' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='TimeParameter'&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:extension base='Parameter'&gt;
                &lt;xs:attribute name='value' type='xs:time' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='ParameterError'&gt;
        &lt;xs:simpleContent&gt;
            &lt;xs:extension base='xs:string'&gt;
                &lt;xs:attribute name='var' type='xs:string' use='required'/&gt;
            &lt;/xs:extension&gt;
        &lt;/xs:simpleContent&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:complexType name='NodeReference'&gt;
        &lt;xs:attributeGroup ref='nodeReference'/&gt;
    &lt;/xs:complexType&gt;
 
    &lt;xs:simpleType name='Color'&gt;
        &lt;xs:restriction base='xs:string'&gt;
            &lt;xs:pattern value='^([0-9a-fA-F]{6})|([0-9a-fA-F]{8})$'/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
 
    &lt;xs:simpleType name='ResponseCode'&gt;
        &lt;xs:restriction base='xs:string'&gt;
            &lt;xs:enumeration value='OK'/&gt;
            &lt;xs:enumeration value='NotFound'/&gt;
            &lt;xs:enumeration value='InsufficientPrivileges'/&gt;
            &lt;xs:enumeration value='Locked'/&gt;
            &lt;xs:enumeration value='NotImplemented'/&gt;
            &lt;xs:enumeration value='FormError'/&gt;
            &lt;xs:enumeration value='OtherError'/&gt;
        &lt;/xs:restriction&gt;
    &lt;/xs:simpleType&gt;
 
&lt;/xs:schema&gt;
        </pre>
    </div>
    <h2>11.
       <a name="moreinfo">For more information</a></h2>
		<p class="" style="">
			For more information, please see the following resources:
		</p>
		<ul class="" style="">
			<li class="" style="">
				<p class="" style="">
					The <a href="http://wiki.xmpp.org/web/Tech_pages/SensorNetworks">Sensor Network section of the XMPP Wiki</a> contains further information about the
					use of the sensor network XEPs, links to implementations, discussions, etc.
				</p>
			</li>
			<li class="" style="">
				<p class="" style="">
					The XEP's and related projects are also available on <a href="https://github.com/joachimlindborg/">github</a>, thanks to Joachim Lindborg.
				</p>
			</li>
		</ul>
	<h2>12.
       <a name="ack">Acknowledgements</a></h2>
        <p class="" style="">Thanks to Joachim Lindborg and Tina Beckman for all valuable feedback.</p>
    <hr><a name="appendices"></a><h2>Appendices</h2>
    <hr><a name="appendix-docinfo"></a><h3>Appendix A: Document Information</h3>
    <p class="indent">
            Series: <a href="http://xmpp.org/extensions/">XEP</a><br>
            Number: 0325<br>
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br>
            Status: 
            <a href="http://xmpp.org/extensions/xep-0001.html#states-Experimental">Experimental</a><br>
            Type:
            <a href="http://xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br>
            Version: 0.1.2<br>
            Last Updated: 2013-06-19<br>
                Approving Body: <a href="http://xmpp.org/council/">XMPP Council</a><br>Dependencies: XEP-0001, XEP-0004, XEP-0030, XEP-0122, XEP-0137, XEP-0141, XEP-0323, XEP-0324, XEP-0331, dynamic-forms<br>
                Supersedes: None<br>
                Superseded By: None<br>
            Short Name: NOT_YET_ASSIGNED<br>
              Source Control: 
                <a class="standardsButton" href="http://gitorious.org/xmpp/xmpp/blobs/master/extensions/xep-0325.xml">HTML</a><br>
            This document in other formats: 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0325.xml">XML</a> 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0325.pdf">PDF</a></p>
    <hr><a name="appendix-authorinfo"></a><h3>Appendix B: Author Information</h3>
    <div class="indent">
      <h3>Peter Waher</h3>
      <p class="indent">
        Email:
        <a href="mailto:peter.waher@clayster.com">peter.waher@clayster.com</a><br>
        JabberID: 
        <a href="xmpp:peter.waher@jabber.org">peter.waher@jabber.org</a><br>
        URI: 
        <a href="http://www.linkedin.com/in/peterwaher">http://www.linkedin.com/in/peterwaher</a><br></p>
    </div>
    <hr><a name="appendix-legal"></a><h3>Appendix C: Legal Notices</h3>
    <div class="indent">
      <h4>Copyright</h4>This XMPP Extension Protocol is copyright (c) 1999 - 2013 by the XMPP Standards Foundation (XSF).<h4>Permissions</h4>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h4>Disclaimer of Warranty</h4><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. In no event shall the XMPP Standards Foundation or the authors of this Specification be liable for any claim, damages, or other liability, whether in an action of contract, tort, or otherwise, arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification. ##</span><h4>Limitation of Liability</h4>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising out of the use or inability to use the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h4>IPR Conformance</h4>
                This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which may be found at &lt;<a href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt; or obtained by writing to XSF, P.O. Box 1641, Denver, CO 80201 USA).
            </div>
    <hr><a name="appendix-xmpp"></a><h3>Appendix D: Relation to XMPP</h3>
    <p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p>
    <hr><a name="appendix-discuss"></a><h3>Appendix E: Discussion Venue</h3>
    <p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p>
    <p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p>
    <p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p>
    <hr><a name="appendix-conformance"></a><h3>Appendix F: Requirements Conformance</h3>
    <p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p>
    <hr><a name="appendix-notes"></a><h3>Appendix G: Notes</h3>
    <div class="indent">
      <p><a name="nt-ID0ETG">1</a>. XEP-0004: Data Forms &lt;<a href="http://xmpp.org/extensions/xep-0004.html">http://xmpp.org/extensions/xep-0004.html</a>&gt;.</p>
      <p><a name="nt-ID0E6G">2</a>. XEP-0122: Data Forms Validation &lt;<a href="http://xmpp.org/extensions/xep-0122.html">http://xmpp.org/extensions/xep-0122.html</a>&gt;.</p>
      <p><a name="nt-ID0ELH">3</a>. XEP-0137: Publishing Stream Initiation Requests &lt;<a href="http://xmpp.org/extensions/xep-0137.html">http://xmpp.org/extensions/xep-0137.html</a>&gt;.</p>
      <p><a name="nt-ID0EXH">4</a>. XEP-0141: Data Forms Layout &lt;<a href="http://xmpp.org/extensions/xep-0141.html">http://xmpp.org/extensions/xep-0141.html</a>&gt;.</p>
      <p><a name="nt-ID0EJEAC">5</a>. XEP-0004: Data Forms &lt;<a href="http://xmpp.org/extensions/xep-0004.html">http://xmpp.org/extensions/xep-0004.html</a>&gt;.</p>
      <p><a name="nt-ID0EDIAC">6</a>. XEP-0326: Internet of Things - Concentrators &lt;<a href="http://xmpp.org/extensions/xep-0326.html">http://xmpp.org/extensions/xep-0326.html</a>&gt;.</p>
      <p><a name="nt-ID0EIMAC">7</a>. 
				XEP-xxxx: Internet of Things - Interoperability &lt;<a href="xep-0000-IoT-Interoperability.html">xep-0000-IoT-Interoperability.html</a>&gt;
            </p>
      <p><a name="nt-ID0ESEAE">8</a>. 
                        XEP-xxxx: Dynamic Data Forms &lt;<a href="dynamic-forms.html">dynamic-forms.html</a>&gt;
                    </p>
      <p><a name="nt-ID0EIMAE">9</a>. XEP-0030: Service Discovery &lt;<a href="http://xmpp.org/extensions/xep-0030.html">http://xmpp.org/extensions/xep-0030.html</a>&gt;.</p>
      <p><a name="nt-ID0E6MAE">10</a>. XEP-0115: Entity Capabilities &lt;<a href="http://xmpp.org/extensions/xep-0115.html">http://xmpp.org/extensions/xep-0115.html</a>&gt;.</p>
      <p><a name="nt-ID0E4NAE">11</a>. XEP-0323: Internet of Things - Sensor Data &lt;<a href="http://xmpp.org/extensions/xep-0323.html">http://xmpp.org/extensions/xep-0323.html</a>&gt;.</p>
      <p><a name="nt-ID0ETIAG">12</a>. XEP-0324: Internet of Things - Provisioning &lt;<a href="http://xmpp.org/extensions/xep-0324.html">http://xmpp.org/extensions/xep-0324.html</a>&gt;.</p>
      <p><a name="nt-ID0EGOAG">13</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p>
    </div>
    <hr><a name="appendix-revs"></a><h3>Appendix H: Revision History</h3>
    <p>Note: Older versions of this specification might be available at <a href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a></p>
    <div class="indent">
      <h4>Version 0.1.2 (2013-06-19)</h4>
      <div class="indent">
				<p class="" style="">Corrected the namespace used for parameterGroup elements in the examples of the document.</p>
				<p class="" style="">Added support for color values with alpha channel.</p>
				<p class="" style="">Updated the schema to more strictly validate references to x-data forms.</p>
				<p class="" style="">Schema was updated to reflect the correct relationship between the x-data subelement in a set operation.</p>
			 (pw)
    </div>
      <h4>Version 0.1.1 (2013-05-07)</h4>
      <div class="indent">
				<p class="" style="">Fixed links to documents with new numbers.</p>
				<p class="" style="">Changed namespace urn:xmpp:sn to urn:xmpp:iot</p>
				<p class="" style="">Schema was corrected: The parameter sub-element in the setResponse element was removed.</p>
			 (pw)
    </div>
      <h4>Version 0.1 (2013-05-06)</h4>
      <div class="indent">
				<p class="" style="">Initial published version approved by the XMPP Council.</p>
			 (psa)
    </div>
      <h4>Version 0.0.1 (2013-03-27)</h4>
      <div class="indent">
                <p class="" style="">First draft.</p>
             (pw)
    </div>
    </div>
    <hr>
    <p>END</p>
  </body>
</html>